.deals-bg
.wrapper
	- render_flash
	.deals-banner
		.deals-stamp-icon.pull-left
		.deals-banner-text.fo-helv.f-b.size-54.white.p-t40.fl.m-l20
			EXCITING DEALS 
		.deals-banner-text-horizontal.fo-helv.size-20.white.f-b.fl.p-t48.m-l10
			EVERY
			%br
			DAY
		.deals-banner-img.fr
	.offer_main_container
		.panel.panel-default.offers-panel
			.panel-heading.offers-heading
				.timer-icon.pull-right
				.col-md-5.p-l45.col-md-offset-4
					%h4.timer-width
						%span.white
							Next Deal Starts in
						%span.pull-right#clock.countdown-time
			.panel-body.offer-panel-body
				.col-md-12.inline-block
					- @deal.each_with_index do |d, i|
						- loc = @location[i]
						- cargroup = @cargroup[i]
						- car_seating = @cargroup[i].seating
						- sold_out = @sold_out[i]
						- discount = @discount[i]
						= render :partial => "main/deals/cardeals", :locals => {:deal => CommonHelper.encode('deal', d.id), :location => loc, :cargroup => cargroup, :starts => d.starts, :ends => d.ends, :sold_out => sold_out, :discount => discount}
					- if @deal.count % 2 == 1
						= render :partial => "main/deals/dealinactive"
		.shadow_line
		.offers-terms-condition
			%h4.fo-helv Terms and Conditions:
			%ol.p-t5.p-l20
				%li.size-16
					Bookings under this offer can not be rescheduled or cancelled.
				%li.size-16
					Additional promo-codes and discounts are not applicable.
				%li.size-16
					Credits or discount will not be given for early return.


:javascript
	function checkJquery() {
		if (window.jQuery) {
			setCountdown();
			pushEvent('Squirrel', 'Page Load', '');
		}
		else {
			window.setTimeout(checkJquery, 1000);
		}
	}

	function checkoutNow() {
		carId = $("#car").val();
		locId = $("#loc").val();
		starts = $("#starts").val();
		ends = $("#ends").val();
		disc = $("#discId").val();
		// alert("//#{HOSTNAME}/#{@city.name.downcase}/bookings/do_flash_booking?car=" + carId + "&loc=" + locId + "&starts=" + starts + "&ends=" + ends + "&flash_discount=" + disc);
		window.location = "//#{HOSTNAME}/#{@city.name.downcase}/bookings/do_flash_booking";
	}

	function setCountdown() {
		var dateObj = new Date();
		var month = dateObj.getMonth() + 1;
		var day = dateObj.getDate();
		// if (dateObj.getHours() >= 0)
		day++;
		month = stringifyDate(month);
		day = stringifyDate(day);
		var countdowndate = dateObj.getFullYear() + "/" + month + "/" + day + " 00:00";
		$('#clock').countdown(countdowndate, function(event) {
			var totalHours = event.offset.totalDays * 24 + event.offset.hours;
			$(this).html(event.strftime(totalHours + 'h: %Mm: %Ss'));
		});
	}

	function stringifyDate(date) {
		if(date < 10) 
			date = '0' + date;
		return date;
	}

	function showMap(lat, lng, name) {
		pushEvent('Squirrel', 'Map', '');
		showModal(name, '/map?lat=' + lat + '&lng=' + lng + '&title=' + name);
	}

	checkJquery();
