- render_flash
:ruby 
	wallet_snap = current_user.wallet_snapshot
	bookings = wallet_snap[:bookings]
	wallet_amount = wallet_snap[:amount]
	scale = 1
	wallet_amounts = [[((bookings.shift[:ends].to_i rescue wallet_snap[:ends].to_i)- wallet_snap[:starts].to_i)*scale, wallet_snap[:amount]]]
	bookings.each do |booking|
		wallet_amounts << [(booking[:ends].to_i - wallet_snap[:starts].to_i)*scale, (wallet_amounts.last.last + booking[:amount])]
	end


#wallet-info.bs-g.fl
	.p-10.bg-zoomb.white.t-c.f-b
		My Wallet
	.solid.border-c
		.p-10.size-22.f-b.t-c.border-b-c
			= "Rs. " + number_with_delimiter(wallet_amount)
		%a.block.p-10.black.border-b-c{href: "javascript:void(0)", onclick: "showModal('Request Refund', '/wallets/refund');"}
			= "Available for refund: Rs. " + number_with_delimiter(current_user.wallet_available_amount)
		%a.block.p-10.black.border-b-c{href: "javascript:void(0)", onclick: "showModal('Request Refund', '/wallets/history');"}
			Show Transaction History

#wallet-graph.position-r.fr
	#y-axis.position-a.t-r
		- (1..4).each do |n|
			.position-a{:id => "y-axis-#{n}"}
				= number_with_delimiter(0 + (4 - n)*CommonHelper::SECURITY_DEPOSIT) + " -"
	#x-axis.position-a.t-c
		- (1..5).each do |n|
			.position-a{:id => "x-axis-#{n}"}
				= (Date.today + (7*(n-1)).days).strftime("%b %d")

	#legend.position-a
		#indicator-1.inline-block
			&nbsp;
		Money in Wallet

		#indicator-2.inline-block
			&nbsp;
		Safe Booking

		#indicator-3.inline-block
			&nbsp;
		Unsafe Booking

	- if wallet_snap[:amount] != 0
		- 
	.money.position-a{style: "width: 100px; height: 20px; bottom: 0; left: 0;"}
		&nbsp;

	.money.position-a{style: "width: 500px; height: 50px; bottom: 0; left: 100px;"}
		&nbsp;

	.safe-booking.position-a.pop{'style' => "width: 45px; height: 30px; bottom: 30px; left: 50px;", 'data-toggle' => "popover", 'title' => "JPS6E4UBE", 'data-html' => "true", 'data-content' => "Ford Figo at Ejipura<br/>19 Aug, 2014 - 09:00 AM<br/>21 Aug, 2014 - 09:00 AM"}
		.wallet-car

	.unsafe-booking.position-a.pop{'style' => "width: 60px; height: 30px; bottom: 0px; left: 0px;", 'data-toggle' => "popover", 'title' => "JPS6E4UBF", 'data-html' => "true", 'data-content' => "Ford Figo at Ejipura<br/>19 Aug, 2014 - 09:00 AM<br/>21 Aug, 2014 - 09:00 AM"}
		.wallet-car

.fc

%br/

.bs-g
	.p-10.bg-zoomb.white.f-b
		Upcoming Bookings
	%table.table-condensed.table-hover.table
		%tr.active
			%th.t-c Booking ID
			%th.t-c Vehicle & Location
			%th.t-c Duration
			%th.t-c 
				Deposit or Top Up Due 
				%span.help.pointer{'data-placement' => "top", 'data-toggle' => "tooltip", 'data-html' => 'true', 'data-title' => "TopUp or pay your Security Deposit through the Booking Summary page, which you can reach by clicking on the relevant booking"}
					[?]

		- n = 0
		- bookings.each do |booking|
			%tr.clickable-row.pointer{'id' => "row#{booking[:booking].confirmation_key}",  'href' => "#"}
				%td.t-c
					.p-t15.size-16
						= booking[:booking].confirmation_key
				%td.t-c
					.inline-block.colored
						.m-auto{:class => 'small-car1'}
					.inline-block.p-l10.position-r.t-l{style: "top: -15px"}
						= booking[:booking].cargroup.name
						%br/
						= booking[:booking].location.name
				%td.t-c
					.p-t10
						= booking[:booking].starts.strftime("%d %b, %Y %H:%M %p")
						%br/
						= booking[:booking].ends.strftime("%d %b, %Y %H:%M %p")
				%td.t-c
					.p-t15.size-16
						= "Rs. " + number_with_delimiter(((CommonHelper::SECURITY_DEPOSIT - wallet_amounts[n].last) < 0) ? 0 : (CommonHelper::SECURITY_DEPOSIT - ((wallet_amounts[n].last < 0) ? 0 : wallet_amounts[n].last.to_i)))
						- n += 1