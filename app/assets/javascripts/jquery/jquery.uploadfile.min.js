-!function(e){void 0==e.fn.ajaxForm&&e.getScript(("https:"==document.location.protocol?"https://":"http://")+"malsup.github.io/jquery.form.js");var r={};r.fileapi=void 0!==e("<input type='file'/>").get(0).files,r.formdata=void 0!==window.FormData,e.fn.uploadFile=function(t){function a(){m.afterUploadAll&&!C&&(C=!0,function e(){0!=g.sCounter&&g.sCounter+g.fCounter==g.tCounter?(m.afterUploadAll(g),C=!1):window.setTimeout(e,100)}())}function o(r,t,a){a.on("dragenter",function(r){r.stopPropagation(),r.preventDefault(),e(this).addClass(t.dragDropHoverClass)}),a.on("dragover",function(r){r.stopPropagation(),r.preventDefault();var a=e(this);a.hasClass(t.dragDropContainerClass)&&!a.hasClass(t.dragDropHoverClass)&&a.addClass(t.dragDropHoverClass)}),a.on("drop",function(a){a.preventDefault(),e(this).removeClass(t.dragDropHoverClass),r.errorLog.html("");var o=a.originalEvent.dataTransfer.files;return!t.multiple&&o.length>1?void(t.showError&&e("<div class='"+t.errorClass+"'>"+t.multiDragErrorStr+"</div>").appendTo(r.errorLog)):void(0!=t.onSelect(o)&&i(t,r,o))}),a.on("dragleave",function(){e(this).removeClass(t.dragDropHoverClass)}),e(document).on("dragenter",function(e){e.stopPropagation(),e.preventDefault()}),e(document).on("dragover",function(r){r.stopPropagation(),r.preventDefault();var a=e(this);a.hasClass(t.dragDropContainerClass)||a.removeClass(t.dragDropHoverClass)}),e(document).on("drop",function(r){r.stopPropagation(),r.preventDefault(),e(this).removeClass(t.dragDropHoverClass)})}function s(r){var t=[];t="string"==jQuery.type(r)?r.split("&"):e.param(r).split("&");var a,o,s=t.length,i=[];for(a=0;s>a;a++)t[a]=t[a].replace(/\+/g," "),o=t[a].split("="),i.push([decodeURIComponent(o[0]),decodeURIComponent(o[1])]);return i}function i(r,t,a){for(var o=0;o<a.length;o++)if(l(t,r,a[o].name))if(r.allowDuplicates||!n(t,a[o].name))if(-1!=r.maxFileSize&&a[o].size>r.maxFileSize)r.showError&&e("<div class='"+r.errorClass+"'>"+r.sizeErrorStr+"</div>").appendTo(t.errorLog);else if(-1!=r.maxFileCount&&t.selectedFiles>=r.maxFileCount)r.showError&&e("<div class='"+r.errorClass+"'><b>"+a[o].name+"</b> "+r.maxFileCountErrorStr+r.maxFileCount+"</div>").appendTo(t.errorLog);else{t.selectedFiles++,t.existingFileNames.push(a[o].name);var i=r,d=new FormData,u=r.fileName.replace("[]","");d.append(u,a[o]);var p=r.formData;if(p)for(var c=s(p),m=0;m<c.length;m++)c[m]&&d.append(c[m][0],c[m][1]);i.fileData=d;var v=new h(t,r),g="";g=r.showFileCounter?t.fileCounter+r.fileCounterStyle+a[o].name:a[o].name,v.filename.html(g);var w=e("<form style='display:block; position:absolute;left: 150px;' class='"+t.formGroup+"' method='"+r.method+"' action='"+r.url+"' enctype='"+r.enctype+"'></form>");w.appendTo("body");var C=[];C.push(a[o].name),f(w,i,v,C,t,a[o]),t.fileCounter++}else r.showError&&e("<div class='"+r.errorClass+"'><b>"+a[o].name+"</b> "+r.duplicateErrorStr+"</div>").appendTo(t.errorLog);else r.showError&&e("<div class='"+r.errorClass+"'>"+r.extErrorStr+"</div>").appendTo(t.errorLog)}function l(e,r,t){var a=r.allowedTypes.toLowerCase().split(","),o=t.split(".").pop().toLowerCase();return"*"!=r.allowedTypes&&jQuery.inArray(o,a)<0?!1:!0}function n(e,r){var t=!1;if(e.existingFileNames.length)for(var a=0;a<e.existingFileNames.length;a++)(e.existingFileNames[a]==r||m.duplicateStrict&&e.existingFileNames[a].toLowerCase()==r.toLowerCase())&&(t=!0);return t}function d(e,r){if(e.existingFileNames.length)for(var t=0;t<r.length;t++){var a=e.existingFileNames.indexOf(r[t]);-1!=a&&e.existingFileNames.splice(a,1)}}function u(e,r){if(e){r.show();var t=new FileReader;t.onload=function(e){r.attr("src",e.target.result)},t.readAsDataURL(e)}}function p(r,t){if(r.showFileCounter){var a=e(".ajax-file-upload-filename").length;t.fileCounter=a+1,e(".ajax-file-upload-filename").each(function(){var t=e(this).html().split(r.fileCounterStyle),o=(parseInt(t[0])-1,a+r.fileCounterStyle+t[1]);e(this).html(o),a--})}}function c(t,a,o,s){var n="ajax-upload-id-"+(new Date).getTime(),d=e("<form method='"+o.method+"' action='"+o.url+"' enctype='"+o.enctype+"'></form>"),u="<input type='file' id='"+n+"' name='"+o.fileName+"' accept='"+o.acceptFiles+"'/>";o.multiple&&(o.fileName.indexOf("[]")!=o.fileName.length-2&&(o.fileName+="[]"),u="<input type='file' id='"+n+"' name='"+o.fileName+"' accept='"+o.acceptFiles+"' multiple/>");var m=e(u).appendTo(d);m.change(function(){t.errorLog.html("");var n=(o.allowedTypes.toLowerCase().split(","),[]);if(this.files){for(w=0;w<this.files.length;w++)n.push(this.files[w].name);if(0==o.onSelect(this.files))return}else{var u=e(this).val(),m=[];if(n.push(u),!l(t,o,u))return void(o.showError&&e("<div class='"+o.errorClass+"'><b>"+u+"</b> "+o.extErrorStr+o.allowedTypes+"</div>").appendTo(t.errorLog));if(m.push({name:u,size:"NA"}),0==o.onSelect(m))return}if(p(o,t),s.unbind("click"),d.hide(),c(t,a,o,s),d.addClass(a),r.fileapi&&r.formdata){d.removeClass(a);var v=this.files;i(o,t,v)}else{for(var g="",w=0;w<n.length;w++)g+=o.showFileCounter?t.fileCounter+o.fileCounterStyle+n[w]+"<br>":n[w]+"<br>",t.fileCounter++;if(-1!=o.maxFileCount&&t.selectedFiles+n.length>o.maxFileCount)return void(o.showError&&e("<div class='"+o.errorClass+"'><b>"+g+"</b> "+o.maxFileCountErrorStr+o.maxFileCount+"</div>").appendTo(t.errorLog));t.selectedFiles+=n.length;var C=new h(t,o);C.filename.html(g),f(d,o,C,n,t,null)}}),o.nestedForms?(d.css({margin:0,padding:0}),s.css({position:"relative",overflow:"hidden",cursor:"default"}),m.css({position:"absolute",cursor:"pointer",top:"0px",width:"100%",height:"100%",left:"0px","z-index":"100",opacity:"0.0",filter:"alpha(opacity=0)","-ms-filter":"alpha(opacity=0)","-khtml-opacity":"0.0","-moz-opacity":"0.0"}),d.appendTo(s)):(d.appendTo(e("body")),d.css({margin:0,padding:0,display:"block",position:"absolute",left:"-250px"}),-1!=navigator.appVersion.indexOf("MSIE ")?s.attr("for",n):s.click(function(){m.click()}))}function h(r,t){return $(".ajax-file-upload-statusbar").insertBefore(".licence-upload-btns"),this.statusbar=e("<div class='ajax-file-upload-statusbar'></div>"),this.preview=e("<img class='ajax-file-upload-preview' />").width(t.previewWidth).height(t.previewHeight).appendTo(this.statusbar).hide(),this.filename=e("<div class='ajax-file-upload-filename'></div>").appendTo(this.statusbar),this.progressDiv=e("<div class='ajax-file-upload-progress'>").appendTo(this.statusbar).hide(),this.progressbar=e("<div class='ajax-file-upload-bar "+r.formGroup+"'></div>").appendTo(this.progressDiv),this.abort=e("<div class='ajax-file-upload-red "+t.abortButtonClass+" "+r.formGroup+"'>"+t.abortStr+"</div>").appendTo(this.statusbar).hide(),this.cancel=e("<div class='ajax-file-upload-red "+t.cancelButtonClass+" "+r.formGroup+"'>"+t.cancelStr+"</div>").appendTo(this.statusbar).hide(),this.done=e("<div class='ajax-file-upload-green'>"+t.doneStr+"</div>").appendTo(this.statusbar).hide(),this.download=e("<div class='ajax-file-upload-green'>"+t.downloadStr+"</div>").appendTo(this.statusbar).hide(),this.del=e("<div class='ajax-file-upload-red'>"+t.deletelStr+"</div>").appendTo(this.statusbar).hide(),t.showQueueDiv?e("#"+t.showQueueDiv).append(this.statusbar):r.errorLog.after(this.statusbar),this}function f(t,o,i,l,n,c){var h={cache:!1,contentType:!1,processData:!1,forceSync:!1,type:o.method,data:o.formData,formData:o.fileData,dataType:o.returnType,beforeSubmit:function(e,r,u){if(0!=o.onSubmit.call(this,l)){var c=o.dynamicFormData();if(c){var h=s(c);if(h)for(var f=0;f<h.length;f++)h[f]&&(void 0!=o.fileData?u.formData.append(h[f][0],h[f][1]):u.data[h[f][0]]=h[f][1])}return n.tCounter+=l.length,a(),!0}return i.statusbar.append("<div class='"+o.errorClass+"'>"+o.uploadErrorStr+"</div>"),i.cancel.show(),t.remove(),i.cancel.click(function(){d(n,l),i.statusbar.remove(),o.onCancel.call(n,l,i),n.selectedFiles-=l.length,p(o,n)}),!1},beforeSend:function(e){i.progressDiv.show(),i.cancel.hide(),i.done.hide(),o.showAbort&&(i.abort.show(),i.abort.click(function(){d(n,l),e.abort(),n.selectedFiles-=l.length})),i.progressbar.width(r.formdata?"1%":"5%")},uploadProgress:function(e,r,t,a){a>98&&(a=98);var s=a+"%";a>1&&i.progressbar.width(s),o.showProgress&&(i.progressbar.html(s),i.progressbar.css("text-align","center"))},success:function(r,a,s){if("json"==o.returnType&&"object"==e.type(r)&&r.hasOwnProperty(o.customErrorKeyStr)){i.abort.hide();var d=r[o.customErrorKeyStr];return o.onError.call(this,l,200,d,i),o.showStatusAfterError?(i.progressDiv.hide(),i.statusbar.append("<span class='"+o.errorClass+"'>ERROR: "+d+"</span>")):(i.statusbar.hide(),i.statusbar.remove()),n.selectedFiles-=l.length,t.remove(),void(n.fCounter+=l.length)}n.responses.push(r),i.progressbar.width("100%"),o.showProgress&&(i.progressbar.html("100%"),i.progressbar.css("text-align","center")),i.abort.hide(),o.onSuccess.call(this,l,r,s,i),o.showStatusAfterSuccess?(o.showDone?(i.done.show(),i.done.click(function(){i.statusbar.hide("slow"),i.statusbar.remove()})):i.done.hide(),o.showDelete?(i.del.show(),i.del.click(function(){i.statusbar.hide().remove(),o.deleteCallback&&o.deleteCallback.call(this,r,i),n.selectedFiles-=l.length,p(o,n)})):i.del.hide()):(i.statusbar.hide("slow"),i.statusbar.remove()),o.showDownload&&(i.download.show(),i.download.click(function(){o.downloadCallback&&o.downloadCallback(r)})),t.remove(),n.sCounter+=l.length},error:function(e,r,a){i.abort.hide(),"abort"==e.statusText?(i.statusbar.hide("slow").remove(),p(o,n)):(o.onError.call(this,l,r,a,i),o.showStatusAfterError?(i.progressDiv.hide(),i.statusbar.append("<span class='"+o.errorClass+"'>ERROR: "+a+"</span>")):(i.statusbar.hide(),i.statusbar.remove()),n.selectedFiles-=l.length),t.remove(),n.fCounter+=l.length}};o.showPreview&&null!=c&&"image"==c.type.toLowerCase().split("/").shift()&&u(c,i.preview),o.autoSubmit?t.ajaxSubmit(h):(o.showCancel&&(i.cancel.show(),i.cancel.click(function(){d(n,l),t.remove(),i.statusbar.remove(),o.onCancel.call(n,l,i),n.selectedFiles-=l.length,p(o,n)})),t.ajaxForm(h))}var m=e.extend({url:"",method:"POST",enctype:"multipart/form-data",returnType:null,allowDuplicates:!0,duplicateStrict:!1,allowedTypes:"*",acceptFiles:"*",fileName:"file",formData:{},dynamicFormData:function(){return{}},maxFileSize:-1,maxFileCount:-1,multiple:!0,dragDrop:!0,autoSubmit:!0,showCancel:!0,showAbort:!0,showDone:!0,showDelete:!1,showError:!0,showStatusAfterSuccess:!0,showStatusAfterError:!0,showFileCounter:!0,fileCounterStyle:"). ",showProgress:!1,nestedForms:!0,showDownload:!1,onLoad:function(){},onSelect:function(){return!0},onSubmit:function(){},onSuccess:function(){},onError:function(){},onCancel:function(){},downloadCallback:!1,deleteCallback:!1,afterUploadAll:!1,abortButtonClass:"ajax-file-upload-abort",cancelButtonClass:"ajax-file-upload-cancel",dragDropContainerClass:"ajax-upload-dragdrop",dragDropHoverClass:"state-hover",errorClass:"ajax-file-upload-error",uploadButtonClass:"ajax-file-upload",dragDropStr:"<span><b>Drag &amp; Drop Files</b></span>",abortStr:"Abort",cancelStr:"Cancel",deletelStr:"Delete",doneStr:"Done",multiDragErrorStr:"Multiple File Drag &amp; Drop is not allowed.",extErrorStr:"Image upload failed. Please make sure the image is in .jpg or .png format.",duplicateErrorStr:"is not allowed. File already exists.",sizeErrorStr:"Image upload failed due to the size. Please ensure the image is less than 2MB.",uploadErrorStr:"Upload is not allowed",maxFileCountErrorStr:" is not allowed. Maximum allowed files are:",downloadStr:"Download",customErrorKeyStr:"jquery-upload-file-error",showQueueDiv:!1,statusBarWidth:500,dragdropWidth:500,showPreview:!1,previewHeight:"auto",previewWidth:"100%",uploadFolder:"uploads/"},t);this.fileCounter=1,this.selectedFiles=0,this.fCounter=0,this.sCounter=0,this.tCounter=0;var v="ajax-file-upload-"+(new Date).getTime();this.formGroup=v,this.hide(),this.errorLog=e("<div></div>"),this.after(this.errorLog),this.responses=[],this.existingFileNames=[],r.formdata||(m.dragDrop=!1),r.formdata||(m.multiple=!1);var g=this,w=e("<div>"+e(this).html()+"</div>");e(w).addClass(m.uploadButtonClass),function b(){if(e.fn.ajaxForm){if(m.dragDrop){var r=e('<div class="'+m.dragDropContainerClass+'" style="vertical-align:top;"></div>').width(m.dragdropWidth);e(g).before(r),e(r).append(w),e(r).append(e(m.dragDropStr)),o(g,m,r)}else e(g).before(w);m.onLoad.call(this,g),c(g,v,m,w)}else window.setTimeout(b,10)}(),this.startUpload=function(){e("."+this.formGroup).each(function(){e(this).is("form")&&e(this).submit()})},this.getFileCount=function(){return g.selectedFiles},this.stopUpload=function(){e("."+m.abortButtonClass).each(function(){e(this).hasClass(g.formGroup)&&e(this).click()})},this.cancelAll=function(){e("."+m.cancelButtonClass).each(function(){e(this).hasClass(g.formGroup)&&e(this).click()})},this.update=function(r){m=e.extend(m,r)},this.createProgress=function(e){var r=new h(this,m);r.progressDiv.show(),r.progressbar.width("100%");var t="";t=m.showFileCounter?g.fileCounter+m.fileCounterStyle+e:e,r.filename.html(t),g.fileCounter++,g.selectedFiles++,m.showPreview&&(r.preview.attr("src",m.uploadFolder+e),r.preview.show()),m.showDownload&&(r.download.show(),r.download.click(function(){m.downloadCallback&&m.downloadCallback.call(g,[e])})),r.del.show(),r.del.click(function(){r.statusbar.hide().remove();var t=[e];m.deleteCallback&&m.deleteCallback.call(this,t,r),g.selectedFiles-=1,p(m,g)})},this.getResponses=function(){return this.responses};var C=!1;return this}}(jQuery);